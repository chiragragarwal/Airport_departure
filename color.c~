#include <stdio.h>
#include <math.h>
#include <stdlib.h>

int search(int *s, int key, int Ls)
{
	int i;
	for(i=0;i<Ls;i++)
		if(s[i]==key)
			return 1;
		else if(s[i]==-1)
			return -1;
	return -1;
}

int color(int n)
{
	int i,j,m=n,l=1,k,Ls;
	
	while(1)
		if(m/10 != 0)
		{
			l++;	//number of digits
			m = m/10;
		}
		else
			break;
				
	printf("No of digits = %d\n",l);
	
	m = n;
	Ls = l*(l+1)/2 ;	//length of search array
	int *a, *s, *M, mul=1;		//Storing digits in an array
	
	a = (int *)malloc(l*sizeof(int));
	M = (int *)malloc(l*sizeof(int));
	s = (int *)malloc(Ls*sizeof(int));
	
	for(i=0;i<l;i++)
	{
		if(m%10 == 1)
			return -1;
		a[l-i-1] = m % 10;		
		s[i] = m%10;
		M[l-i-1] = m%10;
		
		printf(" digit value = %d\n",M[l-i-1]);
		
		mul = mul*a[l-i-1];
		m = m/10;
	}
	
	for(i=l;i<Ls;i++)
		s[i] = -1;

	printf("\n mul = %d\n",mul);
	
	int count = l;
	
	printf("\n M = at start\n");
	for(i=0;i<l;i++)
		printf("%d ",M[i]);
	
	printf("\n S = at start\n");
	for(i=0;i<Ls;i++)
		printf("%d ",s[i]);


	printf("\n l = %d\n",l);
	
	int ret, t,temp;	
	
	for(i=1;i<l;i++)
	{
		printf("\n-----------for i = %d --------\n",i);
		k = i;
		for(j=0;j<(l-i);j++)
		{
			temp = M[k]*a[j];
			printf("\nValue = %d\n",temp);
			
			ret = search(s,temp,Ls);
			printf("\nret = %d for value = %d\n",ret,temp);
			
			if(ret == 1)
				return -1;
			
			M[k] = temp;
			s[count] = temp;
			count++; k++;
			
			printf("\n M = \n");
			for(t=0;t<l;t++)
				printf("%d ",M[t]);
				
			printf("\n S = \n");
			for(t=0;t<Ls;t++)
				printf("%d ",s[t]);
			
		}
					

	}	


	//printf("\nOn search 2 = %d\n",search(s,2,Ls));
	return 1;	
	
	
}


void main()
{
	int n,ret;
	printf("Enter a number : \n");
	scanf("%d",&n);
	
	ret = color(n);
	if(ret>0)
	{
		//printf("\nreturn = %d\n",ret);
		printf("\nThe number %d is colorful \n",n);
		
	}
	else
		printf("\nThe number %d is NOT colorful \n",n);
	
	return;
}
